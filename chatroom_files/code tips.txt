 New log for every day
 $log = date('y-m-d'); (with php)
 
 
 
 
 am using this code but getting some problem. I want to create multiple log.html files according to different session for each user. i dnt want to store data in same or one log.html file.

plz help me as soon as possible.....

thanks for the code.....
 • Reply•Share › 
Avatar
Tim  sunil • 2 years ago
@Sunil I would imagin you could change this:
<? 
session_start(); 
if(isset($_SESSION['name'])){ 
$text = $_POST['text']; 

$fp = fopen("log.html", 'a'); 
fwrite($fp, "<div class='msgln'>(".date("g:i A").") <b&gt".$_SESSION['name']."</b>: ".stripslashes(htmlspecialchars($text))."<br></div>"); 
fclose($fp); 
} 
?>

To this:

<? 
session_start(); 
if(isset($_SESSION['name'])){ 
$text = $_POST['text']; 

$fp = fopen($_Session['name']) ." log.html", 'a'); 
fwrite($fp, "<div class='msgln'>(".date("g:i A").") <b&gt".$_SESSION['name']."</b>: ".stripslashes(htmlspecialchars($text))."<br></div>"); 
fclose($fp); 
} 
?>

then reference the url in the script by echoing it using the php at the point in the script you could do this by setting a variable

$Chatlogurl =$_SESSION['name'] ." log.html"

and put in <?php echo $Chatlogurl;?> where the path is needed in any scripts

then update each bit of the code in the rest of the tutorial to refrence the url this way

hope this helps.

Thanks to the auther of this Tutorial I hope to add a support chat to my website soon too.


Hey, this is the fixed ajax code with Enter key problem solved for IE. Tested on IE9 and Google Chrome.
Enjoy

$(document).unbind('keypress');
$(document).keydown(function(e){
if(e.keyCode == 13) {
var clientmsg = $("#usermsg").val();
$.post("post.php", {text: clientmsg});
$("#usermsg").attr("value", "");
return false;
}
});

// jQuery Document
$(document).ready(function(){
//If user submits the form
$("#submitmsg").click(function(){
var clientmsg = $("#usermsg").val();
$.post("post.php", {text: clientmsg});
$("#usermsg").attr("value", "");
return false;
});

//Load the file containing the chat log
function loadLog(){
var oldscrollHeight = $("#chatbox").attr("scrollHeight") - 20;
$.ajax({
url: "log.html",
cache: false,
success: function(html){
$("#chatbox").html(html); //Insert chat log into the #chatbox div
var newscrollHeight = $("#chatbox").attr("scrollHeight") - 20;
if(newscrollHeight > oldscrollHeight){
$("#chatbox").animate({ scrollTop: newscrollHeight }, 'normal'); //Autoscroll to bottom of div
}
},
});
};
setInterval (loadLog, 2500);	//Reload file every 2.5 seconds

//If user wants to end session
$("#exit").click(function(){
var exit = confirm("Está seguro que desea salir del Chat?");
if(exit==true){window.location = 'index.php?logout=true';}
});
});


